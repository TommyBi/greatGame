{"version":3,"sources":["assets/src/game/view/clearPest/ClearPestView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport SDKManager from \"../../../framework/manager/SDKManager\";\r\nimport { UIEffectType } from \"../../../framework/manager/UIEffectManager\";\r\nimport UIMananger from \"../../../framework/manager/UIMananger\";\r\nimport EventDispath from \"../../../framework/message/EventDispath\";\r\nimport { EventType } from \"../../../framework/message/EventType\";\r\nimport MKUtils from \"../../../framework/tools/MkUtils\";\r\nimport BasePanel from \"../../../framework/ui/BasePanel\";\r\nimport { crop_config } from \"../../consts/CConst\";\r\nimport Global from \"../../consts/Global\";\r\nimport UIType from \"../../consts/UIType\";\r\nimport PlayerModel from \"../../datas/PlayerModel\";\r\nimport ConfigManager from \"../../manager/ConfigManager\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n/**\r\n * 除虫\r\n * TODO:\r\n */\r\n@ccclass\r\nexport default class ClearPestView extends BasePanel {\r\n    @property(cc.Node)\r\n    videoIcon: cc.Node = null;\r\n    @property(cc.Node)\r\n    btnLb: cc.Node = null;\r\n    @property(cc.Node)\r\n    btn_clear: cc.Node = null;\r\n    @property(cc.Node)\r\n    btn_close: cc.Node = null;\r\n    @property(cc.Label)\r\n    titleLb: cc.Label = null;\r\n    @property(cc.Label)\r\n    descLb: cc.Label = null;\r\n\r\n    targetPoint: cc.Vec2;\r\n    mCfg;\r\n    baseCfg: crop_config;\r\n    isFirst = true;\r\n    onEnable(): void {\r\n        // 退出\r\n        EventDispath.on(this.btn_close, this.onBtnCloseHandle, this);\r\n\r\n        EventDispath.on(this.btn_clear, this.onClear, this);\r\n\r\n        EventDispath.addEventListener(EventType.SDK_REWARD_CONFIG, this.onRewardCfg, this);\r\n        EventDispath.addEventListener(EventType.SDK_REWARD_GOT, this.onRewardGot, this);\r\n\r\n        EventDispath.addEventListener(EventType.SDK_REWARD_LOST, this.onRewardLost, this);\r\n\r\n        this.initUI();\r\n    }\r\n\r\n    startShow() {\r\n        this.targetPoint = this.inData[0];\r\n        this.mCfg = this.inData[1];\r\n        this.baseCfg = ConfigManager.getCropById(this.mCfg.cropId);\r\n        this.isFirst = PlayerModel.isFirstClearPest;\r\n    }\r\n\r\n    initUI() {\r\n        console.log(this.baseCfg);\r\n        this.titleLb.string = this.baseCfg.name + \"除虫\";\r\n        this.descLb.string = this.baseCfg.name + \"感染了害虫\\n需要除虫后恢复生长\"\r\n\r\n        if (this.isFirst) {\r\n            this.btnLb.x = 0;\r\n            this.videoIcon.active = false;\r\n        } else {\r\n            this.btnLb.x = 50;\r\n            this.videoIcon.active = true;\r\n        }\r\n\r\n    }\r\n    onRewardCfg(data) {\r\n        SDKManager.getRedPackReward(data.configId);\r\n    }\r\n\r\n    onRewardLost() {\r\n        this.onBtnCloseHandle();\r\n    }\r\n\r\n    onRewardGot(data) {\r\n        EventDispath.send(EventType.SHACHONG, { name: this.baseCfg.name, rewardNum: data.redBean, rewardType: 1, totalMoney: data.userRedBean })\r\n        // UIMananger.showPanel(UIType.popRewardView, null, () => {\r\n        //     // EventDispath.send(EventType.JX_SC, { type: 2, point: this.targetPoint });\r\n        //     EventDispath.send(EventType.SHACHONG);\r\n        // }, UIEffectType.SCALE, 0, { name: this.baseCfg.name, rewardNum: data.redBean, rewardType: 1, totalMoney: data.userRedBean })\r\n        this.onBtnCloseHandle();\r\n    }\r\n    //看视频返回\r\n    onVideoBack() {\r\n        EventDispath.removeByEvent(EventType.VIDEO_BACK, this.onVideoBack, this);\r\n        let name = this.baseCfg.name;\r\n        let rewardNum = 0\r\n        rewardNum = MKUtils.randomNM(400, 600);\r\n        EventDispath.send(EventType.SHACHONG, { name: name, rewardNum: rewardNum, rewardType: 0 });\r\n        this.onBtnCloseHandle();\r\n    }\r\n    onClear() {\r\n        if (this.isFirst) {\r\n            // EventDispath.send(EventType.JX_SC, { type: 2, point: this.targetPoint });\r\n            PlayerModel.isFirstClearPest = false;\r\n            this.onVideoBack();\r\n            // this.onBtnCloseHandle();\r\n        } else {\r\n            let random = MKUtils.randomNMF(0, 100);\r\n            if (random < 30) {\r\n                EventDispath.addEventListener(EventType.VIDEO_BACK, this.onVideoBack, this);\r\n                SDKManager.showAd(Global.VIDEO_CONFIG.video13);\r\n            } else {\r\n                SDKManager.getWormConfig();\r\n            }\r\n        }\r\n    }\r\n\r\n    onClose() {\r\n        EventDispath.send(EventType.CLEAR_PEST_CLOSE)\r\n        this.onBtnCloseHandle();\r\n    }\r\n    onBtnCloseHandle() {\r\n        EventDispath.removeByEvent(EventType.VIDEO_BACK, this.onVideoBack, this);\r\n        super.close();\r\n    }\r\n}\r\n"]}