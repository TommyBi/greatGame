{"version":3,"sources":["assets/src/game/view/main/ShelvePrefab.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { UIEffectType } from \"../../../framework/manager/UIEffectManager\";\r\nimport UIMananger from \"../../../framework/manager/UIMananger\";\r\nimport EventDispath from \"../../../framework/message/EventDispath\";\r\nimport { EventType } from \"../../../framework/message/EventType\";\r\nimport MKUtils from \"../../../framework/tools/MkUtils\";\r\nimport UIType from \"../../consts/UIType\";\r\nimport PlayerModel from \"../../datas/PlayerModel\";\r\nimport ConfigManager from \"../../manager/ConfigManager\";\r\nimport { PopType } from \"../popView/PopView1\";\r\nimport RolePrefab from \"./RolePrefab\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\nexport interface putOnConfig {\r\n    cropId: number,//作物ID\r\n    put_on_num: number,//作物上架数量\r\n}\r\n\r\n@ccclass\r\nexport default class ShelvePrefab extends cc.Component {\r\n\r\n    @property(cc.Sprite)\r\n    bg: cc.Sprite = null;\r\n\r\n    @property(cc.Node)\r\n    crop: cc.Node = null;\r\n    @property(cc.Node)\r\n    buildTips: cc.Node = null;\r\n    @property(sp.Skeleton)\r\n    lvUpEff: sp.Skeleton = null;\r\n\r\n    cropNodeList: cc.Node[];\r\n\r\n    cropList: putOnConfig[] = [];\r\n\r\n    currentNum = 0;//当前作物数量\r\n    mId = 0;//货架ID\r\n    mLv = 0;//货架等级\r\n    // roleNum = 0;//当前货架前的人数\r\n    roleList = [];\r\n    mIndex = 0;\r\n    //每个货架前的起始点\r\n    targetPoints = [\r\n        cc.v2(-140, -50),\r\n        cc.v2(220, -200),\r\n        cc.v2(270, -10),\r\n        cc.v2(-10, 105),\r\n        cc.v2(-300, 200)\r\n    ]\r\n\r\n    allPoints = [];\r\n    cloneAllPoints = [];\r\n    walkLen: number = 0;//走向该摊位的顾客\r\n    shelvesType = [21, 22, 23, 24, 25,]\r\n    onLoad() {\r\n        this.initComponent();\r\n    }\r\n\r\n    start() {\r\n        this.lvUpEff.node.active = false;\r\n        EventDispath.addEventListener(EventType.CASHIER_AUTO_CLOSE, this.closeAuto, this);\r\n\r\n        EventDispath.on(this.buildTips, this.onBuild, this, 0, false);\r\n\r\n        EventDispath.addEventListener(EventType.SHELVE_BUILD, this.onBuildComplete, this);\r\n    }\r\n\r\n    onBuild() {\r\n        //弹出场景元素信息面板\r\n        EventDispath.addEventListener(EventType.VIDEO_BACK, this.onBuildBack, this);\r\n        UIMananger.showPanel(UIType.popView1, null, () => {\r\n            EventDispath.removeByEvent(EventType.VIDEO_BACK, this.onBuildBack, this);\r\n        }, UIEffectType.SCALE, PopType.SHELVE);\r\n    }\r\n    onBuildBack() {\r\n        MKUtils.alertTips(\"扩建货架成功\")\r\n        this.buildTips.active = false;\r\n        PlayerModel.changeShelveSkin(this.mIndex, 1)\r\n        this.changeSkin();\r\n        EventDispath.removeByEvent(EventType.VIDEO_BACK, this.onBuildBack, this);\r\n    }\r\n    onBuildComplete(index) {\r\n        if (this.mIndex == index) {\r\n            this.onBuildBack();\r\n        }\r\n    }\r\n\r\n    initPoint() {\r\n        let target = this.targetPoints[this.mIndex];\r\n        for (let i = 0; i < 8; i++) {\r\n            let targetX = target.x - i * 20;\r\n            let targetY = target.y + i * 8;\r\n            if (this.mIndex == 0 || this.mIndex == 1) {\r\n                targetX = target.x - i * 20;\r\n                targetY = target.y + i * 8;\r\n            }\r\n            let v2 = cc.v2(targetX, targetY);\r\n            this.allPoints.push(v2);\r\n            this.cloneAllPoints.push(v2);\r\n        }\r\n    }\r\n    // updatePoint() {\r\n    //     this.allPoints = [];\r\n    //     let target = this.targetPoints[this.mIndex];\r\n    //     for (let i = 0; i < ConfigManager.getRoleMax(); i++) {\r\n    //         let targetX = target.x - i * 20;\r\n    //         let targetY = target.y + i * 8;\r\n    //         if (this.mIndex == 0 || this.mIndex == 1) {\r\n    //             targetX = target.x - i * 20;\r\n    //             targetY = target.y + i * 8;\r\n    //         }\r\n    //         let v2 = cc.v2(targetX, targetY);\r\n    //         this.allPoints.push(v2);\r\n    //     }\r\n    // }\r\n    getPoint() {\r\n        let p;\r\n        for (let i = 0; i < this.cloneAllPoints.length; i++) {\r\n            if (this.cloneAllPoints[i] != null) {\r\n                p = this.cloneAllPoints[i];\r\n                this.cloneAllPoints[i] = null;\r\n                break;\r\n            }\r\n        }\r\n        if (!p && this.roleNum < 8) {\r\n            for (let i = 0; i < this.cloneAllPoints.length; i++) {\r\n                if (!this.roleList[i]) {\r\n                    p = this.allPoints[i];\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return p;\r\n    }\r\n\r\n    setData(id, index, list?) {\r\n        this.mIndex = index;\r\n        this.roleList.length = 8;\r\n        this.cropList = list || [];\r\n        if (id != 0) {\r\n            this.buildTips.active = false;\r\n            this.changeSkin(0)\r\n            this.setCrop();\r\n        } else {\r\n            this.buildTips.active = true;\r\n        }\r\n    }\r\n    changeSkin(isLvUp = 1) {\r\n        let lv = PlayerModel.getUIConfig().shelvesList[this.mIndex];\r\n        this.mLv = lv;\r\n        if (lv == 0) return;\r\n        this.mId = this.shelvesType[this.mIndex] * 100 + lv;\r\n        MKUtils.loadSpriteFrame(\"texture/prop/shelves/\" + `0${lv}`, (res) => {\r\n            this.bg.spriteFrame = res;\r\n            if (isLvUp) {\r\n                this.lvUpEff.node.active = true;\r\n                this.lvUpEff.animation = \"animation\";\r\n            }\r\n        });\r\n    }\r\n    //选择需要购买的蔬菜\r\n    setCrop() {\r\n        this.cropNodeList.forEach((node) => {\r\n            node.active = false;\r\n            node.name = \"0\";\r\n        })\r\n        this.currentNum = 0;\r\n        let list = this.cropList;\r\n        let len = 0;\r\n        for (let i = 0; i < list.length; i++) {\r\n            let cfg = list[i];\r\n            if (i != 0) len += list[i - 1].put_on_num;\r\n            for (let j = 0; j < cfg.put_on_num; j++) {\r\n                let node: cc.Node;\r\n                if (i == 0) {\r\n                    node = this.cropNodeList[j]\r\n                } else {\r\n                    node = this.cropNodeList[len + j]\r\n                }\r\n                if (!node) {\r\n                    console.log(\"========\");\r\n\r\n                } else {\r\n                    this.currentNum++;\r\n                    node.active = true;\r\n                    node.name = cfg.cropId + \"\";\r\n                    MKUtils.loadSpriteFrame(\"texture/crop/singleIcon/\" + `${cfg.cropId}`, (res) => {\r\n                        node.getComponent(cc.Sprite).spriteFrame = res;\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n    resetCrop(list) {\r\n        this.cropList = list || [];\r\n        this.setCrop();\r\n    }\r\n    //减少后补充\r\n    addCrop(id?) {\r\n        if (!this.mLv) return;\r\n        if (!id) {\r\n            let arr = PlayerModel.getRandomCrop(4 - this.currentNum);\r\n            if (arr.length == 0) return;\r\n            let arr1 = [];\r\n\r\n            for (let j = 0; j < arr.length; j++) {\r\n                let flag = false;\r\n                for (let i = 0; i < this.cropList.length; i++) {\r\n                    if (arr[j].cropId == this.cropList[i].cropId) {\r\n                        this.cropList[i].put_on_num += arr[j].put_on_num;\r\n                        flag = true;\r\n                    }\r\n                }\r\n                if (!flag) arr1.push(arr[j]);\r\n            }\r\n            this.cropList = this.cropList.concat(arr1)\r\n            this.setCrop();\r\n        }\r\n    }\r\n    addOneCrop() {\r\n        if (!this.mLv || this.currentNum >= 4) return;\r\n        let crop = PlayerModel.getOneCrop();\r\n        if (!crop) return;\r\n        let isAdd = false;\r\n        for (let i = 0; i < this.cropList.length; i++) {\r\n            if (crop.cropId == this.cropList[i].cropId) {\r\n                this.cropList[i].put_on_num += 1;\r\n                isAdd = true;\r\n            }\r\n        }\r\n        if (!isAdd) this.cropList.push({ cropId: crop.cropId, put_on_num: 1 })\r\n        let list = this.cropNodeList.filter((node) => {\r\n            return node.name == \"0\";\r\n        });\r\n\r\n        let node: cc.Node = list[0];\r\n        node.opacity = 0;\r\n        this.currentNum++;\r\n        node.active = true;\r\n        node.name = crop.cropId + \"\";\r\n        MKUtils.loadSpriteFrame(\"texture/crop/singleIcon/\" + `${crop.cropId}`, (res) => {\r\n            node.getComponent(cc.Sprite).spriteFrame = res;\r\n            node.runAction(cc.sequence(cc.delayTime(1), cc.fadeIn(1.0)));\r\n        });\r\n    }\r\n    //作物减少\r\n    reduceCrop(id, role: RolePrefab, callBack?) {\r\n        let idx = 0;\r\n        let arr = this.cropList.filter((item, index) => {\r\n            if (item.cropId == id) idx = index;\r\n            return item.cropId == id;\r\n        })\r\n        if (arr.length == 0) {\r\n            //货架缺少对应作物，给出提醒\r\n            console.log(\"缺少该作物\");\r\n            MKUtils.alertTips(\"仓库中缺少该作物\")\r\n            return;\r\n        }\r\n        let cfg = arr[0];\r\n        cfg.put_on_num--;\r\n        this.currentNum--;\r\n        let nodeList = this.cropNodeList.filter((node) => {\r\n            return node.name == id;\r\n        })\r\n\r\n        if (cfg.put_on_num <= 0) {\r\n            this.cropList.splice(idx, 1);\r\n        }\r\n        // this.currentNum--;\r\n        if (nodeList.length > 0) {\r\n            nodeList[0].active = false;\r\n            nodeList[0].name = \"0\"\r\n            PlayerModel.reduceCrop(id);\r\n            if (callBack) callBack();\r\n            this.addOneCrop();\r\n        } else {\r\n            this.cropList.splice(idx, 1);\r\n            role.cropLostBySheleve();\r\n        }\r\n\r\n        let deleteIndex = -1;\r\n\r\n        this.cropList.forEach((item, index) => {\r\n            if (item.put_on_num <= 0) deleteIndex = index;\r\n        })\r\n        if (deleteIndex != -1) this.cropList.splice(deleteIndex, 1);\r\n\r\n        if (this.currentNum == 0) {\r\n            this.cropNodeList.forEach((node) => {\r\n                node.active = false;\r\n                node.name = \"0\";\r\n            })\r\n        }\r\n\r\n        // this.addCrop();\r\n\r\n    }\r\n    isAuto = false;\r\n    changeAuto() {\r\n        // MKUtils.setNodeDelay(this.node, 4, () => {\r\n        //     this.isAuto = true;\r\n        //     for (let i = 0; i < this.roleList.length; i++) {\r\n        //         console.log(\"========自动卖出========\");\r\n        //         MKUtils.setNodeDelay(this.node, i * 1, () => {\r\n        //             if (this.roleList[i]) this.roleList[i].onBuy();\r\n        //         })\r\n        //     }\r\n        // })\r\n    }\r\n    closeAuto() {\r\n        this.isAuto = false;\r\n    }\r\n\r\n    firstPoint = cc.v2();\r\n    addRole(role) {\r\n        this.walkLen--;\r\n        // this.roleList.push(role);\r\n        for (let i = 0; i < this.roleList.length; i++) {\r\n            if (!this.roleList[i]) {\r\n                this.roleList[i] = role;\r\n                role.roleInSheleveIndex = i;\r\n                return;\r\n            }\r\n        }\r\n        let arr = this.roleList.filter((item) => { return item != 0 })\r\n        console.log(\"货架ID：\", this.mIndex, \"顾客数量：\", arr.length);\r\n\r\n    }\r\n    get roleNum() {\r\n        let arr = this.roleList.filter((item) => {\r\n            return item && item != 0;\r\n        })\r\n        return arr.length;\r\n    }\r\n\r\n    refreshRole(role) {\r\n        if (role.roleInSheleveIndex != -1) {\r\n            this.roleList[role.roleInSheleveIndex] = 0;\r\n            this.cloneAllPoints[role.roleInSheleveIndex] = this.allPoints[role.roleInSheleveIndex];\r\n        }\r\n        // let index = this.roleList.indexOf(role);\r\n        // if (index != -1) {\r\n        //     this.roleList[index] = 0;\r\n        // }\r\n        let arr = this.roleList.filter((item) => { return item != 0 })\r\n        console.log(\"货架ID：\", this.mIndex, \"顾客数量：\", arr.length);\r\n    }\r\n\r\n    initComponent() {\r\n        this.buildTips.active = false;\r\n        this.cropNodeList = this.crop.children;\r\n        this.cropNodeList.forEach((node) => {\r\n            node.active = false;\r\n        })\r\n\r\n    }\r\n}\r\n"]}