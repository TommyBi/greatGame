{"version":3,"sources":["assets/src/game/view/order/GetCropView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport SDKManager from \"../../../framework/manager/SDKManager\";\r\nimport { UIEffectType } from \"../../../framework/manager/UIEffectManager\";\r\nimport UIMananger from \"../../../framework/manager/UIMananger\";\r\nimport EventDispath from \"../../../framework/message/EventDispath\";\r\nimport { EventType } from \"../../../framework/message/EventType\";\r\nimport MKUtils from \"../../../framework/tools/MkUtils\";\r\nimport BasePanel from \"../../../framework/ui/BasePanel\";\r\nimport { propType } from \"../../consts/CConst\";\r\nimport Global from \"../../consts/Global\";\r\nimport UIType from \"../../consts/UIType\";\r\nimport PlayerModel from \"../../datas/PlayerModel\";\r\nimport ConfigManager from \"../../manager/ConfigManager\";\r\nimport { OrderItem_Crop } from \"./OrderItem\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n/**\r\n *获取XX\r\n * TODO:\r\n */\r\n@ccclass\r\nexport default class GetCropView extends BasePanel {\r\n\r\n    @property(cc.Sprite)\r\n    icon: cc.Sprite = null;\r\n    @property(cc.Node)\r\n    btn_close: cc.Node = null;\r\n    @property(cc.Node)\r\n    btn_plant: cc.Node = null;\r\n    @property(cc.Node)\r\n    btn_video: cc.Node = null;\r\n    @property(cc.Label)\r\n    descLb1: cc.Label = null;\r\n    @property(cc.Label)\r\n    descLb2: cc.Label = null;\r\n    @property(cc.Label)\r\n    proLb: cc.Label = null;\r\n    @property(cc.Label)\r\n    nameLb: cc.Label = null;\r\n    @property(cc.Label)\r\n    titleLb: cc.Label = null;\r\n    @property(cc.ProgressBar)\r\n    pro: cc.ProgressBar = null;\r\n\r\n    mData;\r\n    onEnable(): void {\r\n        // 退出\r\n        EventDispath.on(this.btn_close, this.onBtnCloseHandle, this);\r\n\r\n        EventDispath.on(this.btn_plant, this.onPlant, this);\r\n        EventDispath.on(this.btn_video, this.onVideo, this);\r\n\r\n        EventDispath.addEventListener(EventType.GET_CROP_CLOSE, this.onBtnCloseHandle, this);\r\n        this.initUI();\r\n    }\r\n    protected onLoad(): void {\r\n    }\r\n    protected start(): void {\r\n    }\r\n\r\n    startShow() {\r\n        this.mData = this.inData[0];\r\n    }\r\n\r\n    initUI() {\r\n        let base = ConfigManager.getCropById(this.mData.cropId);\r\n        this.titleLb.string = \"获取\" + base.name;\r\n        this.nameLb.string = base.name;\r\n\r\n        this.proLb.string = this.mData.num + \"/\" + this.mData.target;\r\n        this.pro.progress = this.mData.num / this.mData.target;\r\n        this.descLb1.string = `1.土地中种植${base.name}等待收获`\r\n        this.descLb2.string = `2.观看视频快速获取${base.name} ×4`;\r\n\r\n        MKUtils.loadSpriteFrame(\"texture/crop/icon/\" + `${this.mData.cropId}`, (res) => {\r\n            this.icon.spriteFrame = res;\r\n        });\r\n\r\n    }\r\n\r\n    onPlant() {\r\n        EventDispath.send(EventType.CROP_PLANT_GET, this.mData.cropId);\r\n    }\r\n    onVideo() {\r\n        if (this.checkHouseMax(4)) {\r\n            MKUtils.alertTips(\"仓库放不下了，快点卖出作物赚钱吧\")\r\n            return;\r\n        }\r\n        EventDispath.addEventListener(EventType.VIDEO_BACK, this.onVideoBack, this);\r\n        SDKManager.showAd(Global.VIDEO_CONFIG.video7)\r\n    }\r\n    onVideoBack() {\r\n        PlayerModel.setHouseAddCrop(this.mData.cropId, 4);\r\n        UIMananger.showPanel(UIType.PopGetCropView, null, null, UIEffectType.SCALE, { id: this.mData.cropId, num: 4 })\r\n        EventDispath.removeByEvent(EventType.VIDEO_BACK, this.onVideoBack, this);\r\n        this.onBtnCloseHandle();\r\n    }\r\n    //检测仓库是否达到上限\r\n    checkHouseMax(value) {\r\n        let lv = PlayerModel.getUIConfig().warehouselv;\r\n        // let arr = ConfigManager.prop.filter((value) => {\r\n        //     return value.id == Number(propType.warehouse + `0${id}`);\r\n        // })\r\n        let cfg = ConfigManager.getPropById(propType.warehouse, lv);\r\n        let currentNum = PlayerModel.getCurrentPutNum();\r\n        if ((cfg.add_num - currentNum) < value) return true;\r\n        return false;\r\n    }\r\n    /** 仅用于关闭操作 */\r\n    onBtnCloseHandle() {\r\n        super.close();\r\n    }\r\n}\r\n"]}