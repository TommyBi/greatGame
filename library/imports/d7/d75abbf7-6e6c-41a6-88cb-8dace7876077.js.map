{"version":3,"sources":["assets/src/framework/message/EventDispath.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import JSHelper from \"../helper/JSHelper\";\nimport MKUtils from \"../tools/MkUtils\";\n\nexport interface touchEventCfg {\n    thisObject: any,\n    nodeList: cc.Node[]\n}\n\nclass EventDispath {\n    NotificationCenter: cc.Node;\n    nodeList = {};\n    touchList = {};\n    constructor() {\n        this.NotificationCenter = new cc.Node();\n    }\n    public static singleton: EventDispath;\n\n    public static getInstance(): EventDispath {\n        if (!this.singleton) {\n            this.singleton = new EventDispath();\n        }\n        return this.singleton;\n    }\n\n    addEventListener(type: string, callback: (notice: any) => void, target) {\n        this.NotificationCenter.on(type, callback, target);\n    }\n\n    send(eventID, arg1?: any) {\n        this.NotificationCenter.emit(eventID, arg1);\n    }\n\n    removeByEvent(type: string, callback: (notice: any) => void, target) {\n        this.NotificationCenter.off(type, callback, target);\n    }\n\n    removeEventListeners(target) {\n        this.NotificationCenter.targetOff(target);\n        if (this.nodeList[target]) {\n            let arr = this.nodeList[target];\n            for (let i = 0; i < arr.length; i++) {\n                arr[i].targetOff(target);\n            }\n        }\n    }\n    /**\n     * 按钮点击缩放\n     * @param btn 触摸的node\n     * @param callback 点击回调\n     * @param thisObj 作用域\n     * @param touchIndex 触发时机，1开始时，2结束时\n     * @param icon 缩放效果node\n     * @param scaleX \n     * @param scaleY \n     */\n    on(btn: cc.Node, callback: (notice: any) => void, thisObj, delayTime = 0.5, isAction = true, touchIndex = 2, icon?: any, scaleX?: number, scaleY?: number) {\n        if (!icon) {\n            icon = btn\n        }\n\n        let preScaleX = btn.scaleX\n        let preScaleY = btn.scaleY\n\n        if (scaleX) {\n            preScaleX = scaleX;\n        }\n\n        if (scaleY) {\n            preScaleY = scaleY;\n        }\n        if (!this.nodeList[thisObj]) {\n            this.nodeList[thisObj] = [];\n        }\n        this.nodeList[thisObj].push(btn);\n\n        this.touchList[btn.uuid] = 0;\n        let self = this;\n        btn.on(cc.Node.EventType.TOUCH_START, function (e) {\n            if (self.touchList[icon.uuid] != 0) return;\n            self.touchList[icon.uuid] = 1;\n            JSHelper.playClickEffect();\n            if (isAction) icon.runAction(cc.scaleTo(0.1, preScaleX * 1.1, preScaleY * 1.1))\n            // icon.setScale(preScaleX*1.1, preScaleY*1.1)\n            if (callback && touchIndex == 1) callback.call(thisObj, e);\n        }, thisObj)\n\n        btn.on(cc.Node.EventType.TOUCH_END, function (e) {\n            if (self.touchList[icon.uuid] == 2) return;\n            self.touchList[icon.uuid] = 2;\n            if (isAction) {\n                icon.runAction(cc.sequence(cc.scaleTo(0.1, preScaleX, preScaleY), cc.delayTime(delayTime), cc.callFunc(() => {\n                    self.touchList[icon.uuid] = 0;\n                })))\n            } else {\n                self.touchList[icon.uuid] = 0;\n\n            }\n            // icon.setScale(preScaleX, preScaleY)\n            if (callback && touchIndex == 2) {\n                callback.call(thisObj, e);\n            }\n        }, thisObj)\n\n        // btn.on(cc.Node.EventType.TOUCH_CANCEL, function (e) {\n        //     icon.runAction(cc.scaleTo(0.2, preScaleX, preScaleY))\n        //     // if (callback && touchIndex == 2) callback.call(thisObj, e);\n        //     // icon.setScale(preScaleX, preScaleY)\n        // }, thisObj)\n    }\n\n}\nexport default EventDispath.getInstance();"]}