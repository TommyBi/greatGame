{"version":3,"sources":["assets/src/framework/manager/UIMananger.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import BaseView from \"../ui/BaseView\";\r\nimport LoaderManager from \"./LoaderManager\";\r\nimport Handler from \"../base/Handler\";\r\nimport GamePoolManager from \"./GamePoolManager\";\r\nimport UIEffectManager, { UIEffectType } from \"./UIEffectManager\";\r\nimport { UIState } from \"../ui/UIState\";\r\nimport BaseTips from \"../ui/BaseTips\";\r\nimport BasePanel from \"../ui/BasePanel\";\r\nimport SDKManager from \"./SDKManager\";\r\n\r\n\r\n\r\nclass UIManager {\r\n    //TODO 保存近期打开的3个面板，如果多余3个时 把最早的释放\r\n    //resDic 资源集合\r\n    private ui_cache = {};\r\n    private view_cache = {};\r\n    private uiStateArr: Array<UIState> = [];//ui打开关闭管理\r\n    private activeStateArr: Array<UIState> = [];//当前激活的uistate\r\n    public viewLayer: cc.Node;\r\n    public guideLayer: cc.Node;\r\n    public uiLayer: cc.Node;\r\n    public tipLayer: cc.Node;\r\n    public effLayer: cc.Node;\r\n    public sceneLayer: cc.Node;\r\n    public currentView: BaseView;\r\n    private static _instance: UIManager;\r\n    public barragePool: cc.NodePool = new cc.NodePool();\r\n\r\n    static instance(): UIManager {\r\n        if (!this._instance) {\r\n            this._instance = new UIManager();\r\n        }\r\n        return this._instance;\r\n    }\r\n\r\n    init() {\r\n        this.viewLayer = new cc.Node('viewLayer');\r\n        this.effLayer = new cc.Node('tipLayer');\r\n        this.uiLayer = new cc.Node('uiLayer');\r\n        this.tipLayer = new cc.Node('tipLayer');\r\n        this.sceneLayer = new cc.Node('sceneLayer');\r\n        this.guideLayer = new cc.Node('guideLayer');\r\n        let canvas = cc.director.getScene().getChildByName('Canvas');\r\n        this.viewLayer.parent = canvas;\r\n        this.sceneLayer.parent = canvas;\r\n        this.effLayer.parent = canvas;\r\n        this.uiLayer.parent = canvas;\r\n        this.tipLayer.parent = canvas;\r\n        this.guideLayer.parent = canvas;\r\n        this.currentView = null;//当前的view\r\n        // this.barragePool = new cc.NodePool();\r\n        //TODO test\r\n        // this.viewLayer.opacity = 60;\r\n        // this.uiLayer.opacity = 60;\r\n\r\n    }\r\n    top: cc.Node;\r\n    setTop() {\r\n        if (!this.top) return;\r\n        if (!this.top.parent) {\r\n            this.viewLayer.addChild(this.top)\r\n            if (cc.winSize.height / cc.winSize.width > (16 / 9 + 0.1)) {\r\n                this.top.setPosition(0, cc.winSize.height / 2 - 210);\r\n            } else {\r\n\r\n                this.top.setPosition(0, cc.winSize.height / 2 - 110);\r\n            }\r\n        }\r\n    }\r\n    guide: cc.Node;\r\n    showGuide() {\r\n        if (!this.guide) return;\r\n        if (!this.guide.parent) {\r\n            this.guide.parent = this.guideLayer;\r\n        }\r\n    }\r\n    hideGuide() {\r\n        if (!this.guide) return;\r\n        if (this.guide.parent) {\r\n            this.guideLayer.removeAllChildren();\r\n        }\r\n    }\r\n\r\n    //显示view\r\n    //pdata UIType中的key\r\n    showView(pdata, ...args) {\r\n        if (!!pdata) {\r\n            if (!!this.currentView) {\r\n                if (this.currentView.uiName === pdata.uname) {\r\n                    this.currentView.on_Show(args);\r\n                    return;\r\n                }\r\n            }\r\n\r\n            LoaderManager.loaderPrefab(pdata.uname, Handler.create((res) => {\r\n                if (!!res) {\r\n                    res = GamePoolManager.instance(res, 'UView-' + pdata.uname);\r\n                } else {\r\n                    return;\r\n                }\r\n\r\n                if (!!this.currentView) {\r\n                    this.closeAllOpenPanel();\r\n                    this.currentView.close();\r\n                }\r\n                let baseView = res.getComponent(\"BaseView\");\r\n\r\n                this.view_cache[pdata.uname] = res;\r\n                if (baseView) {\r\n                    this.currentView = baseView;\r\n                    baseView.setUIName(pdata.uname);\r\n                    baseView.setModuleName(pdata.mname);\r\n                    baseView._show_();\r\n                    baseView.on_Show(args);\r\n                }\r\n                else {\r\n                    cc.error(\"请给面板添加BaseView的子类脚本\");\r\n                }\r\n                // res.parent = this.viewLayer;\r\n                this.viewLayer.addChild(res);\r\n                res.x = 0;\r\n                res.y = 0;\r\n            }, this), pdata.mname);\r\n        } else {\r\n            cc.log('制定打开的脚本不存在');\r\n        }\r\n\r\n    }\r\n\r\n    hideView(name) {\r\n        let baseUI = this.view_cache[name].getComponent(\"BaseView\");\r\n        baseUI._hide_();\r\n        baseUI.on_Hide();\r\n        if (LoaderManager.isRelease(baseUI.moduleName)) {\r\n            LoaderManager.releaseByModule(baseUI.moduleName);\r\n            GamePoolManager.clearByTarget('UView-' + name);\r\n        } else {\r\n            GamePoolManager.putBackByTarget('UView-' + name);\r\n        }\r\n        this.view_cache[name] = null;\r\n    }\r\n    showPanel(pdata, openBack?, closeBack?, effect = null, ...args) {\r\n        console.log(\"打开面板\", JSON.stringify(pdata));\r\n        let state = this.checkPanelOpen(pdata);//如果有已经打开，并且不是可以多开的\r\n        if (state) {\r\n            return;\r\n        }\r\n        //去掉所有弹框效果\r\n        if (effect) {\r\n            effect = null;\r\n        }\r\n        let newSate = this.getUIState(pdata);\r\n        LoaderManager.loaderPrefab(pdata.uname, Handler.create((res, url, state) => {\r\n            if (res) {\r\n                let panel = GamePoolManager.instance(res, 'UPanel-' + pdata.uname);\r\n                let baseUI = panel.getComponent(\"BasePanel\");\r\n                if (!!baseUI) {\r\n                    baseUI.init(pdata.clickClose);\r\n                    baseUI.setUIName(pdata.uname);\r\n                    baseUI.setModuleName(pdata.mname);\r\n                    baseUI.setEffect(effect);\r\n                    baseUI._show_(closeBack, args);//打开前需要执行的函数\r\n                    baseUI.startShow();\r\n                    baseUI.setUIState(state);\r\n                }\r\n                else {\r\n                    cc.error(\"请给面板添加BaseUI的子类脚本\");\r\n                    return;\r\n                }\r\n                // this.ui_cache[pdata.uname] = panel;\r\n                baseUI.setUIParent(this.uiLayer);\r\n                if (!!effect) {\r\n                    UIEffectManager.effect(effect, panel, false, Handler.create(this.effectComplete, this));\r\n                } else {\r\n                    baseUI.on_Show();//真正的打开\r\n                }\r\n                if (openBack) openBack();\r\n            }\r\n\r\n        }, this, true, newSate), pdata.mname);\r\n    }\r\n    checkPanel(panelName) {\r\n        let uiLayerChild = this.uiLayer.children;\r\n        for (let i = 0; i < uiLayerChild.length; ++i) {\r\n            let layer = uiLayerChild[i];\r\n            if (!layer.getComponent(BasePanel)) {\r\n                continue;\r\n            }\r\n            if (layer.getComponent(BasePanel).uiName == panelName) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 通过ui名称隐藏\r\n     * @param name ui名称\r\n     */\r\n    hidePanel(name: any) {\r\n        let uname = '';\r\n        if (typeof (name) === 'string') {\r\n            uname = name;\r\n        } else {\r\n            uname = name.uname;\r\n        }\r\n        let state = this.getUIStateByName(uname, true);\r\n        if (!!state) {\r\n            let baseUI = state.ui;\r\n            baseUI.startHide();\r\n            // let isNew = SDKManager.hasNewOrderReward();\r\n            SDKManager.reportTrigger()\r\n            // if (!!baseUI.effect) {\r\n            //     UIEffectManager.effect(baseUI.effect + \"back\", baseUI.node, false, Handler.create(this.effectBackComplete, this));\r\n            // } else {\r\n            this.effectBackComplete(baseUI.node);\r\n            // }\r\n        }\r\n\r\n    }\r\n\r\n    showTips(pdata, effect = UIEffectType.SCALE, ...args) {\r\n        let url = \"prefab/\" + pdata.mname + \"/\" + pdata.uname;\r\n        let completeCb = (err, res) => {\r\n            if (err) {\r\n                cc.error('资源加载失败--' + url);\r\n                return;\r\n            }\r\n            let tips: cc.Node = GamePoolManager.instance(res, 'UITips-' + pdata.uname);\r\n            let baseTips = tips.getComponent(BaseTips);\r\n            if (baseTips) {\r\n                baseTips.setUIName(pdata.uname);\r\n                baseTips._show_(args);\r\n                baseTips.setDelayRemove(pdata.delayRemove);\r\n                baseTips.setEffect(effect);\r\n                baseTips.startShow();\r\n            } else {\r\n                cc.error(`请给${pdata.uname}添加BaseTips的子类脚本`);\r\n            }\r\n            if (effect) {\r\n                // UIEffectManager.effect(effect, tips, false, Handler.create(this.effectComplete, this));\r\n                UIEffectManager.effect(effect, tips, false, null);//Handle先不传\r\n            }\r\n            baseTips.setUIParent(this.tipLayer);\r\n            baseTips.on_Show();\r\n        }\r\n        let res = cc.loader.getRes(url, cc.Prefab);\r\n        if (res) {\r\n            completeCb(null, res);\r\n            return;\r\n        }\r\n        cc.loader.loadRes(url, cc.Prefab, completeCb);\r\n    }\r\n    checkTips(uName) {\r\n        let tipLayerChild = this.tipLayer.children;\r\n        for (let i = 0; i < tipLayerChild.length; ++i) {\r\n            let layer = tipLayerChild[i];\r\n            if (layer.getComponent(BaseTips)._uiName == uName) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    hideTips(node: cc.Node) {\r\n        if (!node) {\r\n            return;\r\n        }\r\n\r\n        let baseTips = node.getComponent(BaseTips);\r\n        if (baseTips) {\r\n            baseTips.startHide();\r\n            if (baseTips._effect) {\r\n                UIEffectManager.effect(baseTips._effect + \"back\", node, false, Handler.create((tips) => {\r\n                    if (cc.isValid(tips)) {\r\n                        baseTips._hide_();\r\n                    }\r\n                }, this));\r\n            }\r\n        }\r\n    }\r\n\r\n    effectComplete(panel) {\r\n        if (cc.isValid(panel)) {\r\n            let baseUI = panel.getComponent(\"BasePanel\");\r\n            baseUI.on_Show();\r\n        }\r\n    }\r\n\r\n    private effectBackComplete(panel) {\r\n        if (cc.isValid(panel)) {\r\n            let baseUI = panel.getComponent('BasePanel');\r\n            baseUI.on_Hide();\r\n            baseUI._hide_();\r\n            // if (LoaderManager.isRelease(baseUI.moduleName)) {\r\n            //     LoaderManager.releaseByModule(baseUI.moduleName);\r\n            //     GamePoolManager.clearByTarget('UPanel-' + baseUI.uiName);\r\n            // } else {\r\n            //     GamePoolManager.putBackByTarget('UPanel-' + baseUI.uiName);\r\n            // }\r\n        }\r\n    }\r\n\r\n\r\n    isShow(path) {\r\n        if (this.ui_cache[path]) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    private getUIStateByName(name: string, isRemove: boolean = false) {\r\n        for (let index = 0; index < this.activeStateArr.length; index++) {\r\n            const element = this.activeStateArr[index];\r\n            if (name === element.uName) {\r\n                if (isRemove) {\r\n                    this.activeStateArr.splice(index, 1);\r\n                }\r\n                return element;\r\n            }\r\n        }\r\n    }\r\n\r\n    private closeAllOpenPanel() {\r\n        for (let index = 0; index < this.activeStateArr.length; index++) {\r\n            const element = this.activeStateArr[index];\r\n            element.reset();\r\n        }\r\n        this.activeStateArr.length = 0;\r\n    }\r\n\r\n    private checkPanelOpen(data) {\r\n        if (!!data) {\r\n            //检测面板能否多开\r\n            if (!!data.isMutl) {\r\n                return false;\r\n            }\r\n\r\n            for (let index = this.activeStateArr.length - 1; index >= 0; index--) {\r\n                const element = this.activeStateArr[index];\r\n                if (element.isActive && element.uName === data.uname && element.openState > 0) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n\r\n    /**\r\n     * 获得可用的uistate\r\n     */\r\n    private getUIState(data) {\r\n        for (let index = 0; index < this.uiStateArr.length; index++) {\r\n            const element = this.uiStateArr[index];\r\n            if (!element.isActive) {\r\n                element.reset();\r\n                element.setData(data);\r\n                this.activeStateArr.push(element);\r\n                return element;\r\n            }\r\n        }\r\n        let state: UIState = new UIState();\r\n        state.setData(data);\r\n        this.uiStateArr.push(state);\r\n        this.activeStateArr.push(state);\r\n        return state;\r\n\r\n    }\r\n}\r\n\r\nexport default UIManager.instance();"]}