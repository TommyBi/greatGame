{"version":3,"sources":["assets/src/framework/manager/UIMananger.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import BaseView from \"../ui/BaseView\";\nimport LoaderManager from \"./LoaderManager\";\nimport Handler from \"../base/Handler\";\nimport GamePoolManager from \"./GamePoolManager\";\nimport UIEffectManager, { UIEffectType } from \"./UIEffectManager\";\nimport { UIState } from \"../ui/UIState\";\nimport BaseTips from \"../ui/BaseTips\";\nimport BasePanel from \"../ui/BasePanel\";\n\n\n\nclass UIManager {\n  //resDic 资源集合\n  private ui_cache = {};\n  private view_cache = {};\n  private uiStateArr: Array<UIState> = [];//ui打开关闭管理\n  private activeStateArr: Array<UIState> = [];//当前激活的uistate\n  public viewLayer: cc.Node;\n  public maskLayer: cc.Node;\n  public uiLayer: cc.Node;\n  public tipLayer: cc.Node;\n  public sceneLayer: cc.Node;\n  public currentView: BaseView;\n  private static _instance: UIManager;\n  public barragePool: cc.NodePool = new cc.NodePool();\n\n  static instance(): UIManager {\n    if (!this._instance) {\n      this._instance = new UIManager();\n    }\n    return this._instance;\n  }\n\n  init() {\n    this.viewLayer = new cc.Node('viewLayer');\n    this.uiLayer = new cc.Node('uiLayer');\n    this.maskLayer = new cc.Node('maskLayer');\n    this.tipLayer = new cc.Node('tipLayer');\n    this.sceneLayer = new cc.Node('sceneLayer');\n    let canvas = cc.director.getScene().getChildByName('Canvas');\n    this.viewLayer.parent = canvas;\n    this.sceneLayer.parent = canvas;\n    this.maskLayer.parent = canvas;\n    this.uiLayer.parent = canvas;\n    this.tipLayer.parent = canvas;\n    this.currentView = null;//当前的view\n  }\n  top: cc.Node;\n  setTop() {\n    if (!this.top) return;\n    if (!this.top.parent) {\n      this.uiLayer.addChild(this.top)\n      this.top.setPosition(0, cc.winSize.height / 2 - 110);\n    }\n  }\n\n  //显示view\n  //pdata UIType中的key\n  showView(pdata, ...args) {\n    if (!!pdata) {\n      if (!!this.currentView) {\n        if (this.currentView.uiName === pdata.uname) {\n          this.currentView.on_Show(args);\n          return;\n        }\n      }\n\n      LoaderManager.loaderPrefab(pdata.uname, Handler.create((res) => {\n        if (!!res) {\n          res = GamePoolManager.instance(res, 'UView-' + pdata.uname);\n        } else {\n          return;\n        }\n\n        if (!!this.currentView) {\n          this.closeAllOpenPanel();\n          this.currentView.close();\n        }\n        let baseView = res.getComponent(\"BaseView\");\n\n        this.view_cache[pdata.uname] = res;\n        if (baseView) {\n          this.currentView = baseView;\n          baseView.setUIName(pdata.uname);\n          baseView.setModuleName(pdata.mname);\n          baseView._show_();\n          baseView.on_Show(args);\n        }\n        else {\n          cc.error(\"请给面板添加BaseView的子类脚本\");\n        }\n        // res.parent = this.viewLayer;\n        this.viewLayer.addChild(res);\n        res.x = 0;\n        res.y = 0;\n      }, this), pdata.mname);\n    } else {\n      cc.log('制定打开的脚本不存在');\n    }\n\n  }\n\n  hideView(name) {\n    let baseUI = this.view_cache[name].getComponent(\"BaseView\");\n    baseUI._hide_();\n    baseUI.on_Hide();\n    if (LoaderManager.isRelease(baseUI.moduleName)) {\n      LoaderManager.releaseByModule(baseUI.moduleName);\n      GamePoolManager.clearByTarget('UView-' + name);\n    } else {\n      GamePoolManager.putBackByTarget('UView-' + name);\n    }\n    this.view_cache[name] = null;\n  }\n\n  showPanel(pdata, effect = UIEffectType.SCALE, ...args) {\n    console.log(\"打开面板\", JSON.stringify(pdata));\n    let state = this.checkPanelOpen(pdata);//如果有已经打开，并且不是可以多开的\n    if (state) {\n      return;\n    }\n    let newSate = this.getUIState(pdata);\n    LoaderManager.loaderPrefab(pdata.uname, Handler.create((res, url, state) => {\n      if (res) {\n        let panel = GamePoolManager.instance(res, 'UPanel-' + pdata.uname);\n        let baseUI = panel.getComponent(\"BasePanel\");\n        if (!!baseUI) {\n          baseUI.init(pdata.clickClose);\n          baseUI.setUIName(pdata.uname);\n          baseUI.setModuleName(pdata.mname);\n          baseUI.setEffect(effect);\n          baseUI._show_(args);//打开前需要执行的函数\n          baseUI.startShow();\n          baseUI.setUIState(state);\n        }\n        else {\n          cc.error(\"请给面板添加BaseUI的子类脚本\");\n          return;\n        }\n        // this.ui_cache[pdata.uname] = panel;\n        if (!!effect) {\n          UIEffectManager.effect(effect, panel, false, Handler.create(this.effectComplete, this));\n        } else {\n          baseUI.on_Show();//真正的打开\n        }\n        baseUI.setUIParent(this.uiLayer);\n      }\n\n    }, this, true, newSate), pdata.mname);\n  }\n  checkPanel(panelName) {\n    let uiLayerChild = this.uiLayer.children;\n    for (let i = 0; i < uiLayerChild.length; ++i) {\n      let layer = uiLayerChild[i];\n      if (!layer.getComponent(BasePanel)) {\n        continue;\n      }\n      if (layer.getComponent(BasePanel).uiName == panelName) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * 通过ui名称隐藏\n   * @param name ui名称\n   */\n  hidePanel(name: any) {\n    let uname = '';\n    if (typeof (name) === 'string') {\n      uname = name;\n    } else {\n      uname = name.uname;\n    }\n    let state = this.getUIStateByName(uname, true);\n    if (!!state) {\n      let baseUI = state.ui;\n      baseUI.startHide();\n      if (!!baseUI.effect) {\n        //     UIEffectManager.effect(baseUI.effect + \"back\", baseUI.node, false, Handler.create(this.effectBackComplete, this));\n        // } else {\n        this.effectBackComplete(baseUI.node);\n      }\n    }\n\n  }\n\n  showTips(pdata, effect = UIEffectType.SCALE, ...args) {\n    let url = \"prefab/\" + pdata.mname + \"/\" + pdata.uname;\n    let completeCb = (err, res) => {\n      if (err) {\n        cc.error('资源加载失败--' + url);\n        return;\n      }\n      let tips: cc.Node = GamePoolManager.instance(res, 'UITips-' + pdata.uname);\n      let baseTips = tips.getComponent(BaseTips);\n      if (baseTips) {\n        baseTips.setUIName(pdata.uname);\n        baseTips._show_(args);\n        baseTips.setDelayRemove(pdata.delayRemove);\n        baseTips.setEffect(effect);\n        baseTips.startShow();\n      } else {\n        cc.error(`请给${pdata.uname}添加BaseTips的子类脚本`);\n      }\n      if (effect) {\n        // UIEffectManager.effect(effect, tips, false, Handler.create(this.effectComplete, this));\n        UIEffectManager.effect(effect, tips, false, null);//Handle先不传\n      }\n      baseTips.setUIParent(this.tipLayer);\n      baseTips.on_Show();\n    }\n    let res = cc.loader.getRes(url, cc.Prefab);\n    if (res) {\n      completeCb(null, res);\n      return;\n    }\n    cc.loader.loadRes(url, cc.Prefab, completeCb);\n  }\n  checkTips(uName) {\n    let tipLayerChild = this.tipLayer.children;\n    for (let i = 0; i < tipLayerChild.length; ++i) {\n      let layer = tipLayerChild[i];\n      if (layer.getComponent(BaseTips)._uiName == uName) {\n        return true;\n      }\n    }\n    return false;\n  }\n  hideTips(node: cc.Node) {\n    if (!node) {\n      return;\n    }\n\n    let baseTips = node.getComponent(BaseTips);\n    if (baseTips) {\n      baseTips.startHide();\n      if (baseTips._effect) {\n        UIEffectManager.effect(baseTips._effect + \"back\", node, false, Handler.create((tips) => {\n          if (cc.isValid(tips)) {\n            baseTips._hide_();\n          }\n        }, this));\n      }\n    }\n  }\n\n  effectComplete(panel) {\n    if (cc.isValid(panel)) {\n      let baseUI = panel.getComponent(\"BasePanel\");\n      baseUI.on_Show();\n    }\n  }\n\n  private effectBackComplete(panel) {\n    if (cc.isValid(panel)) {\n      let baseUI = panel.getComponent('BasePanel');\n      baseUI.on_Hide();\n      baseUI._hide_();\n      // if (LoaderManager.isRelease(baseUI.moduleName)) {\n      //     LoaderManager.releaseByModule(baseUI.moduleName);\n      //     GamePoolManager.clearByTarget('UPanel-' + baseUI.uiName);\n      // } else {\n      //     GamePoolManager.putBackByTarget('UPanel-' + baseUI.uiName);\n      // }\n    }\n  }\n\n\n  isShow(path) {\n    if (this.ui_cache[path]) {\n      return true;\n    }\n    return false;\n  }\n\n  private getUIStateByName(name: string, isRemove: boolean = false) {\n    for (let index = 0; index < this.activeStateArr.length; index++) {\n      const element = this.activeStateArr[index];\n      if (name === element.uName) {\n        if (isRemove) {\n          this.activeStateArr.splice(index, 1);\n        }\n        return element;\n      }\n    }\n  }\n\n  private closeAllOpenPanel() {\n    for (let index = 0; index < this.activeStateArr.length; index++) {\n      const element = this.activeStateArr[index];\n      element.reset();\n    }\n    this.activeStateArr.length = 0;\n  }\n\n  private checkPanelOpen(data) {\n    if (!!data) {\n      //检测面板能否多开\n      if (!!data.isMutl) {\n        return false;\n      }\n\n      for (let index = this.activeStateArr.length - 1; index >= 0; index--) {\n        const element = this.activeStateArr[index];\n        if (element.isActive && element.uName === data.uname && element.openState > 0) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n\n  /**\n   * 获得可用的uistate\n   */\n  private getUIState(data) {\n    for (let index = 0; index < this.uiStateArr.length; index++) {\n      const element = this.uiStateArr[index];\n      if (!element.isActive) {\n        element.reset();\n        element.setData(data);\n        this.activeStateArr.push(element);\n        return element;\n      }\n    }\n    let state: UIState = new UIState();\n    state.setData(data);\n    this.uiStateArr.push(state);\n    this.activeStateArr.push(state);\n    return state;\n\n  }\n}\n\nexport default UIManager.instance();"]}