{"version":3,"sources":["assets/src/framework/manager/DragManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Global from \"../../game/consts/Global\";\nimport Handler from \"../base/Handler\";\nimport NResponer from \"../message/NResponer\";\nimport MKUtils from \"../tools/MkUtils\";\nimport Utils from \"../tools/Utils\";\n\n//拖拽管理类\nclass DragManager {\n  private BaseDropName: string = 'BaseDropItem';\n  private tempItem: cc.Node = null;\n  private stage: cc.Node = null;\n  private isInitEvent: boolean = false;\n  private dragData = null;\n  private updateHandler: Handler = null;\n  private endHandler: Handler = null;\n  private startHandler: Handler = null;\n  private canDrag: boolean = true;\n  private isInit: boolean = false;\n  private thisObj: any;\n  private initPos: any;//初始位置\n  public _inMerge: boolean = false;\n  private tempItemList: any = {};\n\n  private static _instance: DragManager;\n\n  static instance(): DragManager {\n    if (!this._instance) {\n      this._instance = new DragManager();\n    }\n    return this._instance;\n  }\n\n  /**\n   * 初始化顶级\n   * @param screen \n   */\n  initStage(screen: cc.Node, thisObj) {\n    if (!this.isInit && !cc.isValid(this.stage)) {\n      this.stage = screen;\n      this.isInit = true;\n      this.thisObj = thisObj;\n    }\n  }\n\n  //开始拖动动画\n  startDragHandler(spriteFrame, pos, dragData) {\n    this.initPos = pos;\n    this.dragData = dragData;\n    this.initStageEvent();\n    if (cc.isValid(spriteFrame)) {\n      this.setDragSkin(spriteFrame, pos);\n      this.tempItem.opacity = 255;\n      this.tempItem.setScale(dragData.moveTarget.scale)\n      this.tempItem.stopAllActions();\n      let sc = dragData.moveTarget.scale;\n      this.tempItem.runAction(cc.sequence(cc.scaleTo(0.2, sc + 0.2),\n        cc.scaleTo(0.2, sc)))\n      this.canDrag = true;\n    } else {\n      this.canDrag = false;\n    }\n    this.startHandler && this.startHandler.call(this.thisObj, this.dragData);\n  }\n\n  //设置回调函数\n  //updateHandler 更新函数\n  //返回时回调\n  setCallBackHandler(updateHandler, endHandler, startHandler) {\n    this.updateHandler = updateHandler;\n    this.endHandler = endHandler;\n    this.startHandler = startHandler;\n  }\n\n  //拖放是否成功的回调\n  dragSuccess(state) {\n    NResponer.dispatch('dragStatus', state, this.dragData);\n  }\n\n  private initStageEvent() {\n    if (!this.isInitEvent && cc.isValid(this.stage)) {\n      this.createTempItem();\n      this.isInitEvent = true;\n      this.stage.on(cc.Node.EventType.TOUCH_MOVE, this.moveTouchHandler, this, false);\n      //取消\n      this.stage.on(cc.Node.EventType.TOUCH_CANCEL, this.cancelTouchHandler, this, false);\n      //鼠标弹起\n      this.stage.on(cc.Node.EventType.TOUCH_END, this.endTouchHandler, this, false);\n    }\n  }\n\n  private moveTouchHandler(event) {\n    if (this.canDrag) {\n      // this.tempItem.x = event.getLocationX() - 640;\n      // this.tempItem.y = event.getLocationY() - 360;\n      this.tempItem.setPosition(this.stage.convertToNodeSpaceAR(event.getLocation()));\n      if (!!this.updateHandler) {\n        this.updateHandler.call(this.thisObj, this.tempItem, this.dragData);\n      }\n    }\n  }\n\n  private cancelTouchHandler(event) {\n    if (this.canDrag) {\n      // this.removeStageEvent(event.getLocation());\n      if (this.endHandler) {\n        this.endHandler.call(this.thisObj, this.tempItem, this.dragData, event.getLocation());\n      }\n    }\n  }\n\n  private endTouchHandler(event) {\n    if (this.canDrag) {\n      // this.removeStageEvent(event.getLocation());\n      if (this.endHandler) {\n        this.endHandler.call(this.thisObj, this.tempItem, this.dragData, event.getLocation());\n      }\n    }\n\n  }\n\n  public removeStageEvent(pos?, callBack?, targetPos?, targetCb?, mScale?) {\n    this.isInitEvent = false;\n    this.stage.off(cc.Node.EventType.TOUCH_MOVE, this.moveTouchHandler, this);\n    this.stage.off(cc.Node.EventType.TOUCH_END, this.endTouchHandler, this);\n    this.stage.off(cc.Node.EventType.TOUCH_CANCEL, this.cancelTouchHandler, this);\n    if (cc.isValid(this.tempItem)) {\n      let dis = 0;\n      // let dis = Global.HANDLE_FEEL_ANIMAL_COLLISION_DIS;\n      if (mScale) {\n        this.tempItem.scale = mScale;\n        dis *= mScale;\n      }\n      if (pos) {\n        let dis = MKUtils.twoPointDistance(this.initPos, this.stage.convertToNodeSpaceAR(pos));\n        // cc.log(\"distance\",dis)\n        let delayTime = dis / 2000;\n        this.tempItem.runAction(cc.sequence(cc.moveTo(delayTime, this.initPos).easing(cc.easeSineIn()), cc.callFunc(() => {\n          if (callBack) {\n            callBack.call(this.thisObj);\n          }\n          this.tempItem.opacity = 0;\n        })))\n      } else {\n        // this._inMerge = true;\n        let mScale = this.tempItem.scale;\n        let nodePos = this.tempItem.getParent().convertToNodeSpaceAR(targetPos);\n        this.tempItem.setPosition(nodePos);\n        this.tempItem.runAction(cc.sequence(\n          cc.scaleTo(Utils._FT(3), 0.3),\n          cc.spawn(\n            cc.moveTo(Utils._FT(5), cc.v2(nodePos.x + dis, nodePos.y)).easing(cc.easeSineInOut()),\n            cc.scaleTo(Utils._FT(5), mScale, mScale).easing(cc.easeSineInOut())),\n          cc.delayTime(Utils._FT(3)),\n          cc.spawn(\n            cc.moveTo(Utils._FT(3), cc.v2(nodePos.x, nodePos.y)).easing(cc.easeSineInOut()),\n            // cc.scaleTo(Utils._FT(10),0.3).easing(cc.easeSineInOut())\n            // cc.fadeOut(Utils._FT(5))\n            cc.fadeTo(Utils._FT(3), 85)\n          ),\n          cc.callFunc(() => {\n            this.tempItem.opacity = 0;\n            this.tempItem.zIndex = 999;\n            // this._inMerge = false;\n            targetCb && targetCb();\n          })\n        ));\n        // this.tempItem.runAction(cc.sequence(\n        //     cc.spawn(cc.scaleTo(Utils._FT(3),mScale * 1.8),cc.fadeTo(Utils._FT(3),200),cc.moveTo(Utils._FT(3),nodePos)),\n        //     cc.scaleTo(Utils._FT(3),mScale * 0.90),\n        //     cc.callFunc(()=>{\n        //         this.tempItem.zIndex = -10;\n        //     }),\n        //     cc.scaleTo(Utils._FT(2),mScale * 1.35),\n        //     cc.scaleTo(Utils._FT(2),mScale * 0.9),\n        //     cc.scaleTo(Utils._FT(3),mScale),\n        //     cc.scaleTo(Utils._FT(3),0).easing(cc.easeSineIn()), cc.callFunc(() => {\n        //         this.tempItem.opacity = 0;\n        //         this.tempItem.zIndex = 999;\n        //         targetCb && targetCb();\n        //     })\n        // ));\n        // this.tempItem.runAction(cc.sequence(cc.scaleTo(0.2, 0).easing(cc.easeSineIn()), cc.callFunc(() => {\n        //     this.tempItem.opacity = 0;\n        // })))\n      }\n    }\n    this.canDrag = false;\n  }\n\n  private setDragSkin(skin, pos) {\n    if (cc.isValid(this.tempItem)) {\n      this.tempItem.getComponent(cc.Sprite).spriteFrame = skin;\n      this.tempItem.x = pos.x;\n      this.tempItem.y = pos.y;\n    }\n  }\n\n  private createTempItem() {\n    let mIndex = this.dragData[\"index\"];\n    if (this.tempItemList[mIndex]) {\n      this.tempItem = this.tempItemList[mIndex];\n      return;\n    }\n    if (cc.isValid(this.tempItem)) {\n      return this.tempItem;\n    }\n    this.tempItem = new cc.Node();\n    this.tempItem.addComponent(cc.Sprite);\n    this.tempItem.parent = this.stage;\n    this.tempItemList[mIndex] = this.tempItem;\n  }\n  public getTempItemWorldPos() {\n    if (!this.tempItem) {\n      return cc.v2();\n    }\n    return this.tempItem.getParent().convertToWorldSpaceAR(this.tempItem.getPosition());\n  }\n\n  //获得拖拽对象的数据\n  getDragData() {\n    return this.dragData;\n  }\n}\n\nexport default DragManager.instance();"]}