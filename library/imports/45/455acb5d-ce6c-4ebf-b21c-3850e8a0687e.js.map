{"version":3,"sources":["assets/src/game/view/order/OrderGetScuessView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { UIEffectType } from \"../../../framework/manager/UIEffectManager\";\r\nimport UIMananger from \"../../../framework/manager/UIMananger\";\r\nimport EventDispath from \"../../../framework/message/EventDispath\";\r\nimport { EventType } from \"../../../framework/message/EventType\";\r\nimport MKUtils from \"../../../framework/tools/MkUtils\";\r\nimport BasePanel from \"../../../framework/ui/BasePanel\";\r\nimport UIType from \"../../consts/UIType\";\r\nimport { orderCache } from \"../../datas/PlayerData\";\r\nimport PlayerModel from \"../../datas/PlayerModel\";\r\nimport ConfigManager from \"../../manager/ConfigManager\";\r\nimport { OrderItem_Crop } from \"./OrderItem\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n/**\r\n * 接单成功、温馨提示\r\n * TODO:\r\n */\r\n@ccclass\r\nexport default class OrderGetScuessView extends BasePanel {\r\n\r\n    @property(cc.Node)\r\n    btn_close: cc.Node = null;\r\n    @property(cc.Node)\r\n    btn_giveUp: cc.Node = null;\r\n    @property(cc.Node)\r\n    btn_go: cc.Node = null;\r\n    @property(cc.Node)\r\n    btn_continue: cc.Node = null;\r\n    @property([cc.SpriteFrame])\r\n    lvIconSp: cc.SpriteFrame[] = [];\r\n\r\n    lvIcon: cc.Sprite = null;\r\n\r\n    cLb: cc.Node = null;\r\n    descLb1: cc.Node = null;\r\n    descLb2: cc.Node = null;\r\n    titleLb1: cc.Node = null;\r\n    titleLb2: cc.Node = null;\r\n    proLb: cc.Label = null;\r\n\r\n    cropItems: OrderItem_Crop[] = [];\r\n\r\n    mType = 0;//0接单成功、1温馨提示\r\n    mData: orderCache;\r\n    onEnable(): void {\r\n        // 退出\r\n        EventDispath.on(this.btn_close, this.onBtnCloseHandle, this);\r\n\r\n        EventDispath.on(this.btn_giveUp, this.onGiveUp, this);\r\n        EventDispath.on(this.btn_go, this.onGo, this);\r\n        EventDispath.on(this.btn_continue, this.onContinue, this);\r\n        this.initUI();\r\n\r\n        if (PlayerModel.guideStep >= 0) {\r\n            MKUtils.setNodeDelay(this.node, 0.5, () => {\r\n                EventDispath.send(EventType.GUIDE_UPDATE)\r\n\r\n            })\r\n        }\r\n    }\r\n    protected onLoad(): void {\r\n        this._initComponet();\r\n    }\r\n    protected start(): void {\r\n    }\r\n\r\n    startShow() {\r\n        this.mType = this.inData[0];\r\n        this.mData = this.inData[1];\r\n    }\r\n\r\n    updateData() {\r\n        this.initUI();\r\n    }\r\n    initUI() {\r\n        if (this.mType == 0) {\r\n            this.btn_go.active = true;\r\n            this.descLb1.active = true;\r\n            this.titleLb1.active = true;\r\n            this.cLb.active = true;\r\n        } else {\r\n            this.titleLb2.active = true;\r\n            this.btn_continue.active = true;\r\n            this.btn_giveUp.active = true;\r\n            this.descLb2.active = true;\r\n            this.cLb.active = false;\r\n        }\r\n\r\n        let len = this.mData.cropList.length\r\n        let total = 0;\r\n        let current = 0;\r\n        for (let i = 0; i < len; i++) {\r\n            let data = this.mData.cropList[i];\r\n            let item = this.cropItems[i];\r\n            item.icon.node.active = true;\r\n            item.nameLb.node.active = true;\r\n            item.proLb.node.active = true;\r\n\r\n\r\n            if (data.cropId == 100) {\r\n                item.nameLb.string = \"招待顾客\";\r\n            } else {\r\n                let base = ConfigManager.getCropById(data.cropId);\r\n                item.nameLb.string = base.name;\r\n            }\r\n            total += data.target;\r\n            current += data.num;\r\n            item.proLb.string = data.num + \"/\" + data.target;\r\n            MKUtils.loadSpriteFrame(\"texture/crop/icon/\" + `${data.cropId}`, (res) => {\r\n                item.icon.spriteFrame = res;\r\n            });\r\n        }\r\n        if (this.mData.quality < 2) {\r\n            this.proLb.string = \"无加成\";\r\n        } else {\r\n            this.proLb.string = \"+\" + ConfigManager.order_quality_add[this.mData.quality - 1] + \"%\";\r\n        }\r\n        // this.proLb.string = Math.floor(current / total) * 100 + \"%\"\r\n       if(this.mData.quality>0) this.lvIcon.spriteFrame = this.lvIconSp[this.mData.quality - 1];\r\n       else this.lvIcon.spriteFrame = this.lvIconSp[0];\r\n    }\r\n\r\n    onGiveUp() {\r\n        //仍要放弃\r\n        // EventDispath.send(EventType.ORDER_GIVE_UP)\r\n        // let list = PlayerModel.getOrderList();\r\n        // list[0] = ConfigManager.getOrder();\r\n\r\n        // EventDispath.send(EventType.ORDER_UPDATE_TOP);\r\n        // PlayerModel.orderVideoNum = 0;\r\n        // MKUtils.alertTips(\"订单已放弃，请重新接单\")\r\n        UIMananger.showPanel(UIType.orderGiveUpView, null, null, UIEffectType.SCALE, this.mData)\r\n        this.onBtnCloseHandle();\r\n    }\r\n    onGo() {\r\n        //现在就去\r\n        if (PlayerModel.guideStep >= 0) {\r\n            EventDispath.send(EventType.GUIDE_UPDATE)\r\n        }\r\n        this.onBtnCloseHandle();\r\n    }\r\n    onContinue() {\r\n        this.onBtnCloseHandle();\r\n        //继续完成\r\n    }\r\n    _initComponet() {\r\n        this.lvIcon = this.node.getChildByName(\"lvIcon\").getComponent(cc.Sprite);\r\n        this.proLb = this.node.getChildByName(\"proLb\").getComponent(cc.Label);\r\n        this.descLb1 = this.node.getChildByName(\"descLb1\");\r\n        this.descLb2 = this.node.getChildByName(\"descLb2\");\r\n        this.titleLb1 = this.node.getChildByName(\"titleLb1\");\r\n        this.titleLb2 = this.node.getChildByName(\"titleLb2\");\r\n        this.cLb = this.node.getChildByName(\"cLb\");\r\n\r\n        for (let i = 1; i < 5; i++) {\r\n            let nameLb = this.node.getChildByName(\"nameLb\" + i).getComponent(cc.Label);\r\n            let proLb = this.node.getChildByName(\"cropProLb\" + i).getComponent(cc.Label);\r\n            let icon = this.node.getChildByName(\"icon\" + i).getComponent(cc.Sprite);\r\n\r\n            nameLb.node.active = false;\r\n            proLb.node.active = false;\r\n            icon.node.active = false;\r\n\r\n            this.cropItems.push({ icon: icon, nameLb: nameLb, proLb: proLb });\r\n        }\r\n    }\r\n\r\n    /** 仅用于关闭操作 */\r\n    onBtnCloseHandle() {\r\n        super.close();\r\n    }\r\n\r\n    getGuidePoint() {\r\n        // let node = this.xfzsLb.node;\r\n        let p = this.btn_go.convertToWorldSpaceAR(cc.v2(0, 0));\r\n        // let p = node.convertToWorldSpaceAR(cc.v2(0,0));\r\n        return p;\r\n    }\r\n}\r\n"]}