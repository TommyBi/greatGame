{"version":3,"sources":["assets/src/framework/ui/BaseTips.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import UIType from \"../../game/consts/UIType\";\r\nimport EffectManager from \"../../game/manager/EffectManager\";\r\nimport MessageCenter from \"../../game/manager/MessageCenter\";\r\nimport Handler from \"../base/Handler\";\r\nimport LoaderManager from \"../manager/LoaderManager\";\r\nimport UIMananger from \"../manager/UIMananger\";\r\nimport ComponentHelper from \"../tools/ComponentHelper\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class BaseTips extends cc.Component {\r\n\r\n    _inData : any = null;\r\n    _uiName:string = \"\";\r\n    _effect:any = null;\r\n    modelUI:cc.Node;\r\n    modelUIOpacity : number = 150;\r\n    _delayRemove : any = null;\r\n    public maskURL:string = \"mbg\";//资源放在common模块中\r\n    close(){\r\n        UIMananger.hideTips(this.node);\r\n        this.modelUI.stopAllActions();\r\n        this.modelUI.runAction(cc.fadeOut(0.2));\r\n    }\r\n    setUIParent(parentNode){\r\n        this.node.parent = parentNode;\r\n    }\r\n    _show_(args){\r\n        this._inData = args;\r\n        this._initModule();\r\n    }\r\n    setDelayRemove(dr){\r\n        this._delayRemove = dr;\r\n    }   \r\n    setUIName(uiName){\r\n        this._uiName = uiName;\r\n    }\r\n    setEffect(effect){\r\n        this._effect = effect;\r\n    }\r\n    startHide(){\r\n    }\r\n    _hide_(){\r\n        this.node.destroy();\r\n    }\r\n    on_Show(){\r\n        this._showModuleAction();\r\n        if(this._delayRemove && this._inData){\r\n            let reward = this._inData[0];\r\n            this.node.runAction(cc.sequence(\r\n                cc.delayTime(this._delayRemove),\r\n                cc.callFunc(()=>{\r\n                    this.scheduleOnce(this.close.bind(this),0);\r\n                })\r\n            ));\r\n            let noCoin = this._inData[1];\r\n        }\r\n    }\r\n    private _initModule(){\r\n        if (!cc.isValid(this.modelUI)) {\r\n            this.modelUI = ComponentHelper.createSprite(null,null);\r\n            LoaderManager.loaderSpriteFrame(this.maskURL,Handler.create(this._moduleComplete,this),'commonRes');\r\n            this.modelUI.addComponent(cc.BlockInputEvents);\r\n            this.modelUI.opacity = 0;\r\n            this.modelUI.parent = this.node;\r\n            this.modelUI.setSiblingIndex(0);    \r\n        }\r\n        \r\n    }\r\n    private _moduleComplete(res){\r\n        let sprite:cc.Sprite = ComponentHelper.spriteFrame(this.modelUI,res);\r\n        sprite.trim = false;\r\n        sprite.sizeMode = cc.Sprite.SizeMode.CUSTOM;\r\n        let msize = cc.view.getVisibleSize();\r\n        this.modelUI.width = msize.width;\r\n        this.modelUI.height = msize.height;\r\n        this._clickClose();\r\n    }\r\n    public _showModuleAction(){\r\n        if(cc.isValid(this.modelUI)) {\r\n            this.modelUI.stopAllActions();\r\n            this.modelUI.opacity = 0;\r\n            this.modelUI.runAction(cc.fadeTo(0.2,this.modelUIOpacity));\r\n        }\r\n    }\r\n    startShow(){}\r\n    //点击空白区域关闭\r\n    _clickClose(){\r\n        this.modelUI.on('touchend', (event)=> {\r\n            event.stopPropagation();\r\n            this.node.stopAllActions();\r\n            let clickPos = event.getLocation();\r\n                let visibleSize = cc.view.getVisibleSize();\r\n                clickPos.x = clickPos.x - visibleSize.width / 2;\r\n                clickPos.y = clickPos.y - visibleSize.height / 2;\r\n                let rect = this.node.getBoundingBox();\r\n                if(!rect.contains(clickPos))\r\n                {\r\n                    this.close();\r\n                }\r\n        });\r\n    }\r\n}\r\n"]}